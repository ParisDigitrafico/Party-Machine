!function(a,t,e,n){var l={speed:500,lapping:50,width:800,modal:!0,iframe:!1,type:"get",href:"",url:"",title:"",onLoad:function(){},onOpen:function(){},onClose:function(){},onError:function(){},onDestroy:function(){},onRefresh:function(){}};a.fn.crmPanel=function(n){var o,r={},i=[{id:"pp0",status:!0,caller:"",title:"ptitle_pp0"},{id:"pp1",status:!0,caller:"",title:"ptitle_pp1"},{id:"pp2",status:!0,caller:"",title:"ptitle_pp2"},{id:"pp3",status:!0,caller:"",title:"ptitle_pp3"}],s=a("body");a(".overlay"),a(".panel_modal");a.crmPanel=function(t,e){var n=null;if(r.settings=a.extend({},l,t),r.settings.href&&r.settings.title){if(a(".panel_modal").length<4){a(".panel_modal").removeClass("active");var i,s=f(),c=s.id;s.obj.status,s.obj.caller;return e&&(i=e.attr("id"),e.attr("data-panel",c)),n=d(c,i,r.settings),c}o="Debug info: CanÂ´t add more than 4 panels!",n=!1}else o="href or tittle are missing!",n=!1;"function"==typeof r.settings.onError&&!1===n&&r.settings.onError.call(this,o)};a.crmPanel.close=function(t){a.crmPanel.showLoader(t);var e={};e=a.extend({},l,a("#"+t).data("data-panel-settings"));var n=t,o=a("#"+n),r=o.nextAll(".panel_modal"),i=[];if(i.push(n),0!==o.length){var s;if(r.length)for(var d=0,p=r.length;d<p;d++)s=a(r[d]),i.push(s.attr("id")),c(s,"close");if(a("#ptitle_"+n).prev(".crmPanelTitle").removeClass("BotonSecundario").addClass("BotonPrimario"),c(o,"close",!0),"function"==typeof e.onClose){if(!e.iframe){var f=a("#"+t).data("xhr-ajax-panel");"object"==typeof f&&4!==f.readyState&&f.abort()}e.onClose.call(this,"Debug info: Panels "+i+" closed.")}}else"function"==typeof e.onError&&e.onError.call(this,"Debug info Close: Panels "+n+" were not found!")},a.crmPanel.refresh=function(t,e){var n={};"object"!=typeof e&&(e={}),n=a.extend({},l,a("#"+t).data("data-panel-settings"),e),a("#"+t).data("data-panel-settings",n);var o=t,r=a("#"+o);r.nextAll(".panel_modal");0!==r.length?n.iframe?(a("#"+o).html('<div class="crm-loader"></div>'),a.crmPanel.loadFrame(o,n.href)):(s.find("#"+o).html('<div class="crm-loader"></div>'),a.crmPanel.loadAjax(o,n.href)):"function"==typeof n.onError&&n.onError.call(this,"Debug info refresh: Panels "+o+" were not found!")},a.crmPanel.showLoader=function(t){var e={};e=a.extend({},l,a("#"+t).data("data-panel-settings"));var n=t;0===a("#"+n).length?"function"==typeof e.onError&&e.onError.call(this,"Debug info showLoader: Panels "+n+" were not found!"):a("#"+n).find(".crm-loader").show()},a.crmPanel.hideLoader=function(t){var e={};e=a.extend({},l,a("#"+t).data("data-panel-settings"));var n=t;0===a("#"+n).length?"function"==typeof e.onError&&e.onError.call(this,"Debug info hideLoader: Panels "+n+" were not found!"):a("#"+n).find(".crm-loader").hide()},CLOSE_PANEL=function(t){var e=t.split("_");a.crmPanel.close(e[1])},REFRESH_PANEL=function(t){var e=t.split("_");a.crmPanel.refresh(e[1])},a.crmPanel.loadAjax=function(e,n){var o={};o=a.extend({},l,a("#"+e).data("data-panel-settings"));var r=a("#"+e),i=a("<div />",{id:"secondary",class:"scrollable"}).css({padding:"30px 20px 30px 40px"});r.prepend(i),r=r.find("#secondary");var s=a.ajax({url:n,type:o.type,beforeSend:function(){a("#"+e).find(".crm-loader").show()}});a("#"+e).data("xhr-ajax-panel",s),s.done(function(a){if(-1==a.indexOf("CRM_ERROR_SESSION_EXPIRADA"))r.html(a),"function"==typeof o.onLoad&&o.onLoad.call(this,"Ajax loaded"),"function"==typeof o.onRefresh&&o.onRefresh.call(this,"Ajax refresh");else{var e="<p>&nbsp;</p>";e+='<div id="ntb0" class="notibar notibar-error" style="display: block; top: 0px; opacity: 1;">',e+='<p class="notibar-text">'+CRMConfig.Etiqueta.txt_alerta_error_sesion_expirada+"</p>",e+="</div>",e+='<p align="center"><input type="button" class="crm-btn-small btnAceptarSessionExpirada" value="Aceptar" /></p>',r.html(e),r.find(".btnAceptarSessionExpirada").click(function(){t.location=t.location.href})}}),s.fail(function(a){P({404:function(){var a='"'+e+'","'+n+'"';r.html("<input id='again' onclick='javascript: $.crmPanel.loadAjax("+a+");' class='crm-btn-medium' type='button' value='Reintentar'>")},500:function(){h("error:500")},0:function(){h("Sin conexion")}},a.status)(),"function"==typeof o.onLoad&&o.onLoad.call(this,"Something happened! error:"+a.status)}),s.always(function(t){a("#"+e).find(".crm-loader").hide()})},a.crmPanel.loadFrame=function(t,e){var n={};n=a.extend({},l,a("#"+t).data("data-panel-settings"));var o=a.ajax({url:e,type:n.type}),r=a("#"+t),i=a("<iframe />").attr({name:"iframe_"+t,src:e,frameborder:0,hspace:0,onload:hideLoader(),onerror:showLoader1(t)}).css({width:"100%",height:"100%"}),s=a("<div />",{id:"secondary"}).css({"overflow-y":"hidden"});o.done(function(t){r.css({overflow:"hidden"}).prepend(s),r.find("#secondary").html(i),a("#again").remove(),"function"==typeof n.onLoad&&n.onLoad.call(this,"iframe loaded")}),o.fail(function(a){var n='"'+t+'","'+e+'"';r.html("<input id='again' onclick='javascript: $.crmPanel.loadFrame("+n+");' class='crm-btn-medium' type='button' value='Reintentar'>")})};var d=function(t,e,n){var o=t,r=a("#"+o),i=m();return r.length?r.length?status=!1:status=void 0:(a("<div />",{id:o,class:u(n.modal),"data-right":i,"data-caller":e}).css({display:"none",width:n.width+"px"}).appendTo("body"),"pp0"==o&&a("<div />",{id:"panelTitles"}).css({width:n.width+"px",display:"none"}).html("<ul></ul>").appendTo("body"),g(o,n.title),status=!0),a(".overlay").length||a("<div/>",{class:"overlay"}).appendTo("body"),s.hasClass("dontscroll")||s.addClass("dontscroll"),a("#"+o).length>0&&a("#"+o).data("data-panel-settings",n),n.iframe?(a("#"+o).html('<div class="crm-loader"></div>'),a.crmPanel.loadFrame(o,n.href)):(s.find("#"+o).html('<div class="crm-loader"></div>'),a.crmPanel.loadAjax(o,n.href)),function(t){var e={};e=a.extend({},l,a("#"+t).data("data-panel-settings"));var n=t,o=a("#"+n),r=(o.prevAll(".panel_modal.opened:first"),[]);r.push(n),0!==o.length?(c(o,"open",!0),"function"==typeof e.onOpen&&e.onOpen.call(this,"Debug info Open: Panels "+r+" opened.")):"function"==typeof e.onError&&e.onError.call(this,"Debug info: Panels "+n+" were not found!")}(o),status},c=function(t,e,n){var o;o=a.extend({},l,t.data("data-panel-settings")),P({open:function(){"pp0"==t.attr("id")&&a("#panelTitles").show().animate({right:t.attr("data-right")},o.speed,function(){}),t.removeClass("pclosed").addClass("popened").show().stop().animate({right:t.attr("data-right")},o.speed,function(){t.hasClass("vtnmodal")?a(".overlay").show():a(".overlay").hide()}),n&&t.addClass("active")},close:function(){"pp0"==t.attr("id")&&a("#panelTitles").show().animate({right:-t.outerWidth(!0)},o.speed,function(){}),t.removeClass("popened active").addClass("pclosed").stop().animate({right:-t.outerWidth(!0)},o.speed,function(){(t.hasClass("vtnmodal")&&t.prevAll(".panel_modal:first").hasClass("vtnmodal")||!t.hasClass("vtnmodal")&&t.prevAll(".panel_modal:first").hasClass("vtnmodal"))&&a(".overlay").show(),(t.hasClass("vtnmodal")&&!t.prevAll(".panel_modal:first").hasClass("vtnmodal")||!t.hasClass("vtnmodal")&&!t.prevAll(".panel_modal:first").hasClass("vtnmodal"))&&a(".overlay").hide(),function(t){var e={};e=a.extend({},l,t.data("data-panel-settings"));var n=t.attr("id");if(to=t.nextAll(".panel_modal"),_removed=[],t.stop().hide().remove(),a("#ptitle_"+n).hide().stop().remove(),_removed.push(n),a("#"+t.attr("data-caller")).removeClass("blocked"),to.length)for(var o,r=0,i=to.length;r<i;r++)o=a(to[r]),_removed.push(o.attr("id")),o.stop().hide().remove(),a("#"+o.attr("data-caller")).removeClass("blocked"),a("#ptitle_"+o.attr("id")).hide().stop().remove();v(n),p(),(a("#closeAll").hasClass("clicked")||0===a(".panel_modal").length)&&a("#closeAll").remove(),0===a(".panel_modal").length&&(a(".overlay").hide(),s.removeClass("dontscroll")),"pp0"==n&&a("#panelTitles").remove(),"function"==typeof e.onDestroy&&e.onDestroy.call(this,"Debug info: Panels destroyed: "+_removed)}(t)})}},e)()},p=function(){var t=a(".panel_modal:last");t.hasClass("popened")&&t.addClass("active")},f=function(){for(var a=null,t=null,e=0,n=i.length;e<n;e++)if(i[e].status){a=(t=i[e]).id,t.status=!1;break}return{id:a,obj:t}},u=function(a){return a?"panel_modal vtnmodal":"panel_modal"},m=function(){return-a(".panel_modal").length*r.settings.lapping},h=function(a){},v=function(a){for(var t=0,e=i.length;t<e;t++)if(i[t].id===a){switch(t){case 0:if(i[t].status)break;i[t].status=!0,t++;case 1:if(i[t].status)break;i[t].status=!0,t++;case 2:if(i[t].status)break;i[t].status=!0,t++;case 3:if(i[t].status)break;i[t].status=!0}break}},g=function(t,e){a("#panelTitles ul li").removeClass("BotonPrimario").addClass("BotonSecundario"),a("#panelTitles ul").append('<li id="ptitle_'+t+'" class="crmPanelTitle BotonPrimario"><a href="#">'+e+"</a></li>"),a("#closeAll").length||(a("#panelTitles ul").prepend('<li id="closeAll" class="BotonSecundario"><a href="#" class="ui-state-default ui-state-ryv-ajuste-close"><i class="fa fa-times" id="btnClosePanel"></i></a></li>'),a("#panelTitles ul li#closeAll a").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}))},P=function(a,t){return a[t]};return void 0===t.crmPanelInicializado&&(t.crmPanelInicializado=!1),0==t.crmPanelInicializado&&(s.on("click",".npanel, .panel_modal, .crmPanelTitle, #again, #Notificaciones, #user",function(a){a.stopPropagation()}),s.on("click",".CLOSE_AJAX",function(t){t.preventDefault(),t.stopPropagation();var e=a(this).closest(".panel_modal").attr("id");a.crmPanel.close(e),a("#ptitle_"+e).prev(".crmPanelTitle").removeClass("BotonSecundario").addClass("BotonPrimario")}),s.on("click","#closeAll",function(t){t.preventDefault(),t.stopPropagation(),a.crmPanel.close("pp0"),a(this).addClass("clicked")}),s.on("click","#closeAll",function(t){t.preventDefault(),t.stopPropagation(),a.crmPanel.close("pp0"),a(this).addClass("clicked")}),s.on("click",".crmPanelTitle",function(t){t.preventDefault(),t.stopPropagation();var e=a(this);if(!e.hasClass("BotonPrimario")&&e.hasClass("BotonSecundario")){var n=e.attr("id").split("_"),l=a("#"+n[1]).nextAll(".panel_modal").attr("id");a.crmPanel.close(l),e.removeClass("BotonSecundario").addClass("BotonPrimario")}}),a(e).on("click keyup",function(t){if(a(".panel_modal").length&&a(t.target)[0]!=a("#Rutas")[0]&&"again"!=a(t.target).attr("id")){var e=a(".panel_modal.popened.active:last").prop("id");if("keyup"==t.type&&27!=t.keyCode)return;a("#"+e).hasClass("vtnmodal")||(a.crmPanel.close(e),a("#ptitle_"+e).prev(".crmPanelTitle").removeClass("BotonSecundario").addClass("BotonPrimario"))}}),t.crmPanelInicializado=!0),this.each(function(){var t=a(this);t.on("click",function(e){e.preventDefault(),$btn=a(e.target),r.settings=a.extend({},l,n),function(a){a.attr("data-speed")&&(r.settings.speed=a.attr("data-speed")),a.attr("data-lapping")&&(r.settings.lapping=a.attr("data-lapping")),a.attr("data-width")&&(r.settings.width=a.attr("data-width")),a.attr("data-modal")&&(r.settings.modal="true"===a.attr("data-modal")),a.attr("data-iframe")&&(r.settings.iframe="true"===a.attr("data-iframe")),a.attr("data-title")?r.settings.title=a.attr("data-title"):"function"==typeof r.settings.onError&&r.settings.onError.call(this,"Debug info: data-title is missing"),a.attr("data-url")&&(r.settings.url=a.attr("data-url")),a.attr("href")&&(r.settings.href=a.attr("href")),a.attr("data-href")&&(r.settings.href=a.attr("data-href"))}(t),P({true:function(){a.crmPanel.close(t.attr("data-panel"))},false:function(){a.crmPanel(r.settings,$btn)}},$btn.hasClass("blocked"))(),$btn.toggleClass("blocked")})})}}(jQuery,window,document),$("run").crmPanel();